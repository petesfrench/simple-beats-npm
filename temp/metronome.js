!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Metronome=t():e.Metronome=t()}(self,(function(){return(()=>{"use strict";var e={868:(e,t,s)=>{s.d(t,{default:()=>o});const i="sine",n=new(window.AudioContext||window.webkitAudioContext),o=class{constructor(e=90,t=16,s=0){this._BPM=e,this._timeSigniture=t,this._gain=s,this._pushNote=0,this._noteVolumes=[1,1,1,1],this._noteLength=.05,this._oscillatorType=i,this._frequency=220,this._samplesArray=[],this._samplesLoaded=!1,this._accentChecked=!1,this._notesInQueue=[],this._playing=!1,this._timerID,this._nextNoteTime=0,this._currentNote=0,this._lookahead=25,this._scheduleAheadTime=.1}set BPM(e){this._BPM=Number(e)}set timeSigniture(e){this._timeSigniture=Number(e)}updateAccentChecked(){this._accentChecked^=!0}set noteVolumes(e){this._noteVolumes=e}set budge(e){this._pushNote=e}set noteLength(e){this._noteLength=Number(e)}set oscillatorType(e){let t;switch(e){case"sine":case"square":case"sawtooth":case"triangle":t=e;break;default:t=i}this._oscillatorType=t}set frequency(e){e<=40&&(e=40),this._frequency=e}set gain(e){this._noteVolumes=new Array(this._timeSigniture).fill(e)}_valueChecks(){for(;this._noteVolumes.length<this._timeSigniture;)this._noteVolumes=[...this._noteVolumes,...this._noteVolumes]}start(){this._playing||(this._currentNote=0,this._nextNoteTime=n.currentTime,this._valueChecks(),this._scheduler(),this._playing=!0)}stop(){window.clearTimeout(this._timerID),this._playing=!1}_nextNote(){const e=15/this._BPM;this._nextNoteTime+=e,this._currentNote++,this._currentNote>=this._timeSigniture&&(this._currentNote=0)}aListener(e){}registerListener(e){this.aListener=e}_scheduleSamples(e,t){this._notesInQueue.push({note:e,time:t}),this.aListener(this._notesInQueue,n.currentTime,this._samplesArray[0].name),this._notesInQueue.length>=this._timeSigniture&&this._notesInQueue.splice(0,1),this._accentChecked&&this._samplesArray.length>=2&&e===this._timeSigniture-1?this._playSample(n,this._samplesArray[1].audioBuffer,this._noteVolumes[e]):this._playSample(n,this._samplesArray[0].audioBuffer,this._noteVolumes[e])}_scheduleOscillator(e,t){this._notesInQueue.push({note:e,time:t});const s=n.createOscillator(),i=n.createGain();s.connect(i),i.connect(n.destination),s.type=this._oscillatorType,0===this._noteVolumes[e]&&i.gain.setValueAtTime(0,n.currentTime),this._accentChecked?e===this._timeSigniture-1?s.frequency.value=2*this._frequency:s.frequency.value=this._frequency:this._accentChecked||(s.frequency.value=this._frequency),s.start(t+this._pushNote),s.stop(t+this._noteLength+this._pushNote)}_scheduler(){let e;e||(e=this),function t(){for(;e._nextNoteTime<n.currentTime+e._scheduleAheadTime;)e._samplesLoaded?e._scheduleSamples(e._currentNote,e._nextNoteTime):e._scheduleOscillator(e._currentNote,e._nextNoteTime),e._nextNote();e._timerID=window.setTimeout(t,e._lookahead)}()}loadSamples(e){this._setUpSample(e).then((e=>{this._samplesArray=[...e],this._samplesLoaded=!0}))}async _loadSound(e,t){try{const s=await fetch(t),i=await s.arrayBuffer();return await e.decodeAudioData(i)}catch(e){console.log(e)}}async _setUpSample(e){return Promise.all(e.map((async e=>{let t={};return t.audioBuffer=await this._loadSound(n,e),t.name=e.match(/([^\/]+)(?=\.\w+$)/)[0].replace(/-/,"_"),t}))).then((e=>e))}_playSample(e,t,s=1){const i=e.createBufferSource(),o=n.createGain();return i.buffer=t,i.connect(o),o.connect(e.destination),o.gain.value=s,i.start(),i}}}},t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={exports:{}};return e[i](n,n.exports,s),n.exports}return s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s(868)})().default}));